---
import Layout from "@/layouts/Layout";

import { getCollection, getEntry } from "astro:content";

import BuildFilter from "@/components/builds/BuildFilter";
import Build from "@/components/content/snippets/BuildAlt";
import Container from "@/components/Container";
import Icon from "@/components/Icon";
import Pagination from "@/components/Pagination";
import Picture from "@/components/images/Picture";

// content
export async function getStaticPaths({ paginate }) {
    const allBuilds = (await getCollection("builds")).sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

    return paginate(allBuilds, { pageSize: 12 });
}
const { page } = Astro.props;

const featuredBuildId = "777233-2022-ford-bronco";
const featuredBuild = await getEntry("builds", featuredBuildId);
---

<Layout title="Texas High-Performance Off-Road Vehicle Builds" description="THOR Off-Road is the top off-road parts and installation outfitter in Texas for Ford Chevrolet GMC RAM Toyota Lexus Jeep">
    <Picture src="builds/215615/01.jpg" buildId={215615} alt="A modified RAM 3500 in Dripping Springs, TX" loading="eager" class="header-image object-[50%,50%]" />

    <div class="-mt-20 section section-bottom">
        <Container padding={true}>
            <div class="grid grid-cols-2 sm:gap-4">
                <!-- black content area -->
                <div class="bg-black col-span-2 md:col-span-1 text-white box-spacing space-y-8">
                    <div class="space-y-8">
                        <h1>THOR Off-Road Custom Builds</h1>
                        <p class="text-base">We're designing and building amazing vehicles each and every day. Browse through a small selection of our most recent finished builds.</p>
                    </div>
                </div>

                <div class="bg-white box-spacing col-span-2 md:col-span-1 flex justify-center items-center">
                    <div class="space-y-4">
                        <div class="flex gap-2">
                            <Icon icon="hero/ArrowRightCircleFill" class="w-7 h-auto -rotate-[135deg]" />
                            <h3 class="h4">Featured Build</h3>
                        </div>

                        <div class="space-y-2">
                            <div class="text-base font-medium tracking-tight">{`${featuredBuild.data.year} ${featuredBuild.data.make} ${featuredBuild.data.model}`}</div>
                            <div class="text-xs line-clamp-2 md:line-clamp-4 text-neutral-600">{`${featuredBuild.data.summary}`}</div>

                            <div><a href={featuredBuild.slug} class="text-xs font-medium">See Build &#x2192;</a></div>
                        </div>
                    </div>
                </div>
            </div>
        </Container>
    </div>

    <Container>
        <div class="mb-8 flex justify-between">
            <BuildFilter />

            <div class="hidden md:block">
                <Pagination page={page} />
            </div>
        </div>
    </Container>

    <div class="bg-neutral-50 section">
        <Container>
            <div>
                <div class="grid grid-cols-3 gap-10">
                    {page.data.map((b) => <Build build={b} sizes="(min-width:640px) 50vw, (min-width:1024px) 25vw, (min-width:1280px) 300px, 100vw" height="h-[15em]" />)}
                </div>

                <div class="mt-16 flex justify-between">
                    <div class="text-sm">
                        Page {page.currentPage} of {page.lastPage}
                    </div>

                    <Pagination page={page} />
                </div>
            </div>
        </Container>
    </div>
</Layout>
