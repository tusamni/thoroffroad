---
import Layout from "../layouts/Layout.astro";

// components
import { Icon } from "astro-icon";
import Background from "@/components/content/Background";
import Button from "../components/buttons/Button.astro";
import Container from "../components/Container.astro";
import Gallery from "../components/images/Gallery.astro";
import HeadingBase from "@/components/content/headings/HeadingBase";
import Picture from "../components/images/Picture.astro";
import Section from "../components/Section.astro";
import Testimonial from "../components/Testimonial.astro";

// config
import { Business } from "../config";

// content
import { getCollection } from "astro:content";
const allTestimonials = await getCollection("testimonials");
const allBrands = await getCollection("brands", ({ data }) => {
    return data.featured == true;
});

// images
import { getBuildImage } from "../functions/Image.js";
---

<Layout>
    <HeadingBase>
        <Picture src="shop/2022-03-09/shop-shoot_01.jpg" alt="FOX Shocks waiting to be installed" slot="background" loading="eager" class="sm:absolute object-cover w-full h-[25vh] sm:h-full" />

        <h1 slot="heading">{Business.nameLong} partners with the best.</h1>
        <div slot="description">We've built partnerships with the best brands, nobody carries more Carli parts or knows the performance suspension options for your vehicle better than {Business.nameLong}.</div>

        <div class="flex flex-col gap-4 sm:flex-row">
            <Button icon="hero/WrenchScrewdriverFill" theme="secondary" href="/contact">Build Your Dream Truck</Button>
            <Button icon="hero/ArrowRightCircleFill" href="/builds">See Our Builds</Button>
        </div>
    </HeadingBase>

    <Background>
        <Section>
            <Container>
                <!-- brand logos -->
                <div class="mx-auto grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6 md:gap-12">
                    {
                        allBrands
                            .map((b) => (
                                <div class="bg-stone-50 p-6 flex justify-center rounded-sm">
                                    <Icon name={`brands/${b.data.logo}`} alt={b.data.title} class="h-8 lg:h-16 w-full lg:w-1/2 object-contain text-stone-900 place-self-center" />
                                </div>
                            ))
                            .slice(0, 12)
                    }
                </div>
            </Container>
        </Section>
    </Background>

    <Gallery>
        <div class="grid grid-cols-12 grid-rows-1 md:grid-rows-2 md:h-[1000px] gap-4 md:gap-0">
            <Picture src="shop/2023-02-23/shop-shoot_01.jpg" alt="Ford Super Duty in Dripping Springs, TX" class="object-cover w-full h-full col-span-12 md:col-span-6 md:row-span-2 object-bottom" sizes="(min-width: 768px) 50vw, 100vw" />
            <Picture src={getBuildImage(298562, 13)} class="object-cover w-full h-full col-span-12 md:col-span-3 md:row-span-1" sizes="(min-width: 768px) 25vw, 100vw" />
            <Picture src={getBuildImage(405642, 5)} class="object-cover w-full h-full col-span-12 md:col-span-3 md:row-span-1" sizes="(min-width: 768px) 25vw, 100vw" />
            <Picture src={getBuildImage(266375, 2)} class="object-cover w-full h-full col-span-12 md:row-start-2 md:col-start-7 md:col-span-6" sizes="(min-width: 768px) 50vw, 100vw" />
        </div>
    </Gallery>

    <Background>
        <Section>
            <Container classes="space-y-16">
                <div class="grid grid-cols-3 gap-y-16">
                    <h2 class="text-center md:text-left col-span-3 md:col-span-2 md:order-0">We're building our <br /> customer's dream vehicles.</h2>
                    <div class="place-self-center order-last col-span-3 md:justify-self-end md:order-1 md:col-span-1">
                        <Button href="/builds" theme="primary">See All Builds</Button>
                    </div>
                    <div class="col-span-3 grid grid-cols-1 md:grid-cols-2 md:order-last xl:grid-cols-3 gap-8">{allTestimonials.map((t) => <Testimonial content={t.data} />).slice(0, 6)}</div>
                </div>
            </Container>
        </Section>
    </Background>

    <Gallery>
        <div class="grid grid-cols-12 grid-rows-1 md:grid-rows-2 md:h-[1000px] gap-4 md:gap-0">
            <Picture src={getBuildImage(108058, 3)} class="object-cover w-full h-full col-span-12 md:col-span-6 md:row-span-2" sizes="(min-width: 768px) 50vw, 100vw" />
            <Picture src={getBuildImage(276780, 6)} class="object-cover w-full h-full col-span-12 md:col-span-3 md:row-span-1" sizes="(min-width: 768px) 25vw, 100vw" />
            <Picture src={getBuildImage(453172, 2)} class="object-cover w-full h-full col-span-12 md:col-span-3 md:row-span-1" sizes="(min-width: 768px) 25vw, 100vw" />
            <Picture src={getBuildImage(791924, 7)} class="object-cover w-full h-full col-span-12 md:row-start-2 md:col-start-7 md:col-span-6" sizes="(min-width: 768px) 50vw, 100vw" />
        </div>
    </Gallery>
</Layout>
