---
import Layout from "../layouts/Layout.astro";

// components
import { Icon } from "astro-icon";
import Background from "../components/content/Background.astro";
import Button from "../components/buttons/Button.astro";
import Container from "../components/Container.astro";
import Section from "../components/Section.astro";
import Link from "../components/buttons/Link.astro";
import Picture from "../components/images/Picture.astro";
import Pill from "../components/buttons/Pill.astro";
import Testimonial from "../components/Testimonial.astro";

// config
import { Business } from "../config";

// content
import { getCollection } from "astro:content";
const allTestimonials = await getCollection("testimonials");
const allBuilds = await getCollection("builds", ({ data }) => {
    return data.homepageFeatured;
});
const allBrands = await getCollection("brands", ({ data }) => {
    return data.logo;
});

// images
import { getBuildImage } from "../functions/Image.js";

// images
const headers = [
    {
        src: "shop/2023-02-23/shop-shoot_01.jpg",
        alt: "Ford Super Duty in Dripping Springs, TX",
    },
    {
        src: "shop/2022-12-05/shop-shoot_15.jpg",
        alt: "Truck outfitting in Austin, TX",
    },
    {
        src: "builds/298562/13.jpg",
        alt: "Highly modified Dodge RAM Power Wagon",
    },
    {
        src: "shop/2022-03-09/shop-shoot_01.jpg",
        alt: "A collection of Fox truck struts",
    },
];
---

<Layout>
    <!-- header images -->
    <div class="grid grid-cols-2 lg:grid-cols-4 grid-rows-2 lg:grid-rows-1 h-[400px] md:h-[600px] lg:h-[500px]">
        <div class="units order-1">
            <Picture src={headers[0].src} class="object-cover w-full h-full object-[50%,80%] lg:object-center" alt={headers[0].alt} />
            <Picture src={headers[0].src} class="object-cover w-full h-full object-[50%,80%] lg:object-center hidden lg:block" alt={headers[0].alt} />
        </div>
        <div class="units order-2">
            <Picture src={headers[1].src} class="object-cover w-full h-full object-left-bottom lg:object-center" alt={headers[1].alt} />
            <Picture src={headers[1].src} class="object-cover w-full h-full object-left-bottom lg:object-center hidden lg:block" alt={headers[1].alt} />
        </div>
        <div class="units order-4 lg:order-3">
            <Picture src={headers[2].src} class="object-cover w-full h-full object-left lg:object-center" alt={headers[2].alt} />
            <Picture src={headers[2].src} class="object-cover w-full h-full object-left lg:object-center" alt={headers[2].alt} />
        </div>
        <div class="units order-3 lg:order-4">
            <Picture src={headers[3].src} class="object-cover w-full h-full object-top sm:object-[50%,20%] lg:object-center" alt={headers[3].alt} />
            <Picture src={headers[3].src} class="object-cover w-full h-full object-top lg:object-center" alt={headers[3].alt} />
        </div>
    </div>

    <!-- brands -->
    <Section classes="bg-stone-200">
        <Container classes="relative z-10">
            <div class="grid grid-cols-1 items-center gap-16 lg:grid-cols-2">
                <div class="mx-auto max-w-xl lg:mx-0 space-y-8">
                    <h1>{Business.nameLong} partners with the best.</h1>
                    <p class="text-xl leading-8 text-stone-600">We've built partnerships with the best brands, nobody carries more Carli parts or knows the performance suspension options for your vehicle better than {Business.nameLong}.</p>

                    <div class="flex flex-col gap-4 sm:flex-row sm:justify-center lg:justify-start items-center gap-x-6">
                        <Button icon="hero/WrenchScrewdriverFill" theme="secondary" href="/contact">Build Your Dream Truck</Button>
                        <Button icon="hero/ArrowRightCircleFill" theme="tertiary" href="/builds">See Our Builds</Button>
                    </div>
                </div>

                <!-- brand logos -->
                <div class="mx-auto grid max-w-xl items-center grid-cols-3 gap-6 md:gap-12 lg:mx-0 lg:max-w-none">
                    {allBrands.map((b) => <Icon name={`brands/${b.data.logo}`} alt={b.data.title} class="h-12 w-1/2 object-contain text-stone-800 place-self-center" />).slice(0, 15)}
                </div>
            </div>
        </Container>
    </Section>

    <Background theme="secondary">
        <Section>
            <Container>
                <div class="grid grid-cols-1 items-start gap-16 md:grid-cols-2">
                    <div class="hidden md:block md:relative h-full w-full">
                        <Picture src="team/jamey/jamey.jpg" alt="Jamey Whitlock of THOR Off-Road" class="md:absolute h-full w-full object-cover md:object-[60%,10%] lg:object-[50%,30%] shadow-2xl rounded" />
                    </div>

                    <div>
                        <div class="text-base leading-7 text-stone-700 md:py-16 lg:py-32">
                            <h2 class="lg:max-w-lg">The {Business.nameLong} Difference.</h2>
                            <div class="text-lg leading-8 text-stone-700">
                                <p class="mt-8 text-lg sm:text-xl leading-8 sm:leading-9">{Business.nameShort} is the premiere truck and off-road vehicle outfitter in Texas with the unique automotive knowledge, technical expertise, and deep customer insights to consistently deliver the truck or adventure vehicle of our customers' dreams. Come experience your own purpose-built vehicle.</p>
                                <p class="mt-8 text-stone-700">
                                    {Business.nameShort} is passionate about creating purpose-built vehicles for our customers, but we also thrive on building strong personal relationships that are based on competence and trust. We are experts in all things off-road and love to inspire and help our customers to build the truck or adventure vehicle that they have always wanted. We aren't satisfied until
                                    we hear our customers say,
                                    <em>“Wow, I can't believe that's my truck!”</em>
                                </p>
                                <div class="mt-16 flex flex-col gap-4">
                                    <Picture src="team/jamey/jamey-headshot.jpg" alt="Jamey Whitlock of THOR Off-Road" class="md:hidden rounded-full w-16 h-auto border border-stone-600" />

                                    <div class="flex flex-col gap-2">
                                        <p class="font-cursive font-medium text-4xl">Jamey Whitlock</p>
                                        <p class="text-stone-500 font-medium">Owner, {Business.nameLong}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </Container>
        </Section>

        <Section>
            <Container>
                <div class="mx-auto max-w-xl text-center space-y-6">
                    <Pill theme="secondary">Testimonials</Pill>
                    <h2>We're building our customer's dream vehicles.</h2>
                </div>

                <div class="mx-auto mt-16 flow-root sm:mt-20">
                    <div class="sm:columns-2 lg:columns-3 gap-8">
                        {allTestimonials.map((t) => <Testimonial content={t.data} />).slice(0, 9)}
                    </div>
                </div>
            </Container>
        </Section>

        <Section>
            <Container>
                <div class="grid grid-cols-4 space-y-12 sm:space-y-0 sm:items-center sm:gap-16">
                    <h2 class="max-w-xl sm:max-w-none col-span-4 sm:col-span-2 order-1 text-center sm:text-start">We love showing off our customer's trucks.</h2>
                    <Button theme="tertiary" icon="hero/ArrowRightCircleFill" href="/builds" classes="order-3 sm:order-2 col-span-4 sm:col-span-2 justify-self-center sm:justify-self-end">See Our Builds</Button>
                    <div class="col-span-4 columns-1 sm:columns-2 md:columns-3 gap-8 space-y-8 order-2 sm:order-3">
                        {allBuilds.map((b) => <Picture src={getBuildImage(b.data.id, b.data.featuredImage)} class="rounded shadow-2xl" sizes="600px" alt={b.data.summary} />).slice(0, 15)}
                    </div>
                </div>
            </Container>
        </Section>
    </Background>
</Layout>

<style>
    /* image reflection */
    .units > :last-child {
        transform: rotatex(180deg) translate(0px);
        mask-image: linear-gradient(transparent 80%, white 180%);
        -webkit-mask-image: linear-gradient(transparent 80%, white 180%);
    }
</style>
