---
// components
import { Icon } from "astro-icon";
import Container from "@/components/Container";

// content
import { getCollection } from "astro:content";

// get parts data
const allParts = await getCollection("parts");
---

<div class="py-10 px-4" x-data={`{ partsMega : false }`} x-on:mouseenter={`partsMega = true`} x-on:mouseover.away={`partsMega = false`} x-on:click={`partsMega = true`} :class={`partsMega ? 'bg-white' : ''`}>
    <button class="flex gap-1 lg:gap-2">
        <div class="flex gap-2 text-lg">
            Parts
            <Icon name="bi:caret-down" class="h-auto w-3" x-show={`!partsMega`} />
            <Icon name="bi:caret-down-fill" class="h-auto w-3" x-show={`partsMega`} x-cloak />
        </div>
    </button>

    <div x-cloak x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100 scale-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100 scale-100" x-transition:leave-end="opacity-0" x-show="partsMega" class="absolute inset-0 top-[104px] z-30 w-full">
        <div class="w-full bg-gradient-to-tr from-stone-700 via-stone-800 to-stone-800">
            <Container classes="py-8">
                <div class="grid grid-cols-4 gap-2 lg:grid-cols-4 lg:gap-4">
                    {
                        allParts.map((p) => (
                            <a href={`/parts/${p.slug}`} title={p.data.title} class="relative flex items-center border border-stone-600">
                                <div class="hidden h-full w-12 items-center bg-stone-700 p-2 lg:flex">
                                    <Icon name={`${p.data.logo}_outline`} class="w-12 text-stone-300" />
                                </div>

                                <div class="z-10 flex h-full w-full flex-col from-stone-700 to-stone-600 p-4 hover:bg-gradient-to-br">
                                    <div class="text-lg font-medium text-white group-hover:underline">{p.data.title}</div>
                                    <p class="line-clamp-2 text-sm font-light text-stone-300">{p.data.brands.map((b, index) => (index ? ", " : "") + b.title)}</p>
                                </div>
                            </a>
                        ))
                    }
                </div>

                <a href="/parts" class="mt-8 flex w-fit justify-center text-lg italic text-stone-300 underline">All Parts</a>
            </Container>
        </div>
    </div>
</div>
